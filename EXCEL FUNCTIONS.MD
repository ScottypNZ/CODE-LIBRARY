## ASSOCIATIVE LOOK UP MATRIX

### STEP 1 

```VBA
TAKE DATA TABLE, I.E. ROOM, BUBBLE, ADDRESS AND ADD TO POWER QUERY, LOAD TO EXCEL SHEET.
CALL THIS INDEX 1

ADD INDEX           = Table.AddIndexColumn(Source, "INDEX", 1, 1)  
UNPIVOT INDEX       = Table.UnpivotOtherColumns(#"Added Index", {"INDEX"}, "Attribute", "Value")   
REORDER             = Table.ReorderColumns(#"Unpivoted Columns",{"Value", "Attribute", "INDEX"})
REMOVE ATTRIBUTE    = Table.RemoveColumns(#"Reordered Columns1",{"Attribute"})
```

### STEP 2
```VBA
ADD SECOND INDEX COLUMN [INDEX 2LOOK]
VLOOKUP ATTRIBUTE VALUE, RETURNING FIRST INDEX, FIRST MATCH

VLOOKUP             = VLOOKUP([@Value],MATRIX[[Value]:[INDEX]],2,0)

```
### STEP 3
```VBA
ADD THIRD INDEX COLUMN [INDEX 2MIN]
MIN IF, RETURNING MIN VALUE ASSOCIATED WITH EACH INDEX VALUE (1) IN SECOND INDEX

MIN IF              {=MIN(IF([INDEX]=[@INDEX],[INDEX-2MIN]))}
```

### STEP 4
```VBA
ADD FOURTH INDEX COLUMN [INDEX 3LOOK]
VLOOKUP ATTRIBUTE VALUE, RETURNING THIRD INDEX, FIRST MATCH

VLOOKUP             = VLOOKUP([@Value],MATRIX[[Value]:[INDEX-2MIN]],4,0)

```
### STEP 
```VBA
ADD FIFTH INDEX COLUMN [INDEX 3MIN]
MIN IF, RETURNING MIN VALUE ASSOCIATED WITH EACH INDEX VALUE (1) IN FORTH INDEX

MIN IF              {=MIN(IF([INDEX]=[@INDEX],[INDEX-2MIN]))}
```
									
![image](https://user-images.githubusercontent.com/60175119/154594196-e4ffbf74-2853-4fb2-b2fb-cf287aa761d5.png)



